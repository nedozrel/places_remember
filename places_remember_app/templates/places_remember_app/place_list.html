{% extends 'base.html' %}
{% load account %}
{% load static %}

{% block head %}
  {#  YMaps do not work without referer header  #}
  <meta name="referrer" content="origin"/>
  {#  TODO: move api key to .env  #}
  <script src="https://api-maps.yandex.ru/3.0/?apikey=4ea56e6e-4561-4712-9f69-ece12b9cdd85&lang=ru_RU"></script>
  <script src="{% static 'places_remember_app/js/placesList.js' %}"></script>
{% endblock %}

{% block content %}
  <div>
    <img src="{{ user.socialaccount_set.all.0.get_avatar_url }}" alt="avatar">
  </div>
  <div>
    {% user_display user %}
  </div>
  <div>
    <a href="{% url 'account_logout' %}">
      Logout
    </a>
  </div>
  <div class="add-place-popup">
    <form action="{% url 'places' %}" method="post" class="add-place-form">
      {% csrf_token %}
      {% for field in form %}
        <div class="form-field add-place-form__item">
          <div class="form-field__error">
            {{ field.errors }}
          </div>
          <div class="form-field__input">{{ field }}</div>
        </div>
      {% endfor %}
      <input type="submit">
    </form>
  </div>
  <div id="map" style="width: 600px; height: 400px"></div>
  <div class="places">
    {% for place in places %}
      <div class="place places__item">
        <a href="{% url 'places_detail' place.id %}">
          <div class="place__title">
            {{ place.title }}
          </div>
          <div class="place__description">
            {{ place.description }}
          </div>
        </a>
      </div>
    {% endfor %}
  </div>
{% endblock %}

